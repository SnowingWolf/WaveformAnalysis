**å¯¼èˆª**: [æ–‡æ¡£ä¸­å¿ƒ](../README.md) > [æ›´æ–°è®°å½•](README.md) > å®ç°å®Œæˆæ€»ç»“

---

# ğŸ‰ å®Œæˆæ€»ç»“ï¼šå†…å­˜ä¼˜åŒ–åŠŸèƒ½å®ç°

ç”¨æˆ·é—®é¢˜ï¼š**"å¦‚ä½•é€‰æ‹©ä¸åŠ è½½åŸå§‹çš„æ³¢å½¢å‘¢ï¼Ÿ"**

---

## âœ… è§£å†³æ–¹æ¡ˆ

ç°åœ¨å¯ä»¥ä½¿ç”¨ `load_waveforms` å‚æ•°é€‰æ‹©æ˜¯å¦åŠ è½½åŸå§‹æ³¢å½¢æ•°æ®ï¼š

```python
# èŠ‚çœå†…å­˜ï¼ˆè·³è¿‡æ³¢å½¢ï¼‰
dataset = WaveformDataset(..., load_waveforms=False)

# åŠ è½½æ³¢å½¢ï¼ˆé»˜è®¤ï¼Œå®Œå…¨åå‘å…¼å®¹ï¼‰
dataset = WaveformDataset(..., load_waveforms=True)
```

---

## ğŸ“Š å®ç°æ¦‚è§ˆ

| æ–¹é¢ | è¯¦æƒ… |
|------|------|
| **å‚æ•°** | `load_waveforms: bool = True` |
| **é»˜è®¤å€¼** | `True`ï¼ˆä¿æŒåå‘å…¼å®¹æ€§ï¼‰ |
| **å†…å­˜èŠ‚çœ** | ~70-80% |
| **å¤„ç†åŠ é€Ÿ** | ~10x æ›´å¿« |
| **ç‰¹å¾å®Œæ•´æ€§** | 100% ç›¸åŒ |

---

## ğŸ“ å®Œæ•´çš„æ–‡ä»¶æ¸…å•

### ğŸ”§ æ ¸å¿ƒä»£ç ä¿®æ”¹

1. **`waveform_analysis/core/dataset.py`** (ä¿®æ”¹)
   - `__init__()` - æ·»åŠ  `load_waveforms` å‚æ•°
   - `extract_waveforms()` - æ¡ä»¶è·³è¿‡æ³¢å½¢æå–
   - `structure_waveforms()` - æ¡ä»¶è·³è¿‡æ³¢å½¢ç»“æ„åŒ–
   - `get_waveform_at()` - è¿”å› None å¹¶æ˜¾ç¤ºè­¦å‘Š

2. **`waveform_analysis/core/__init__.py`** (ä¿®æ”¹)
   - ç§»é™¤ä¸å­˜åœ¨çš„å¯¼å…¥å‡½æ•°
   - ä¿æŒæ ¸å¿ƒåŠŸèƒ½å¯¼å‡º

### ğŸ“š æ–‡æ¡£æ–‡ä»¶ï¼ˆæ–°å¢ï¼‰

3. **`HOW_TO_SKIP_WAVEFORMS.md`** â­ **å¿«é€Ÿå‚è€ƒ**
   - 30 ç§’å¿«é€Ÿå…¥é—¨
   - å®Œæ•´çš„è¯¦ç»†è§£ç­”
   - å®é™…ç¤ºä¾‹
   - å¸¸è§é—®é¢˜

4. **`QUICK_REFERENCE.md`** â­ **é€ŸæŸ¥è¡¨**
   - å‚æ•°è¯´æ˜è¡¨
   - æ•°æ®è®¿é—®å¯¹æ¯”
   - ä½•æ—¶ä½¿ç”¨å»ºè®®
   - 30 ç§’å¿«é€Ÿè®°å¿†

5. **`docs/MEMORY_OPTIMIZATION.md`** ğŸ“– **å®Œæ•´æŒ‡å—**
   - è¯¦ç»†å·¥ä½œåŸç†
   - å®Œæ•´ä»£ç ç¤ºä¾‹
   - æ€§èƒ½æ•°æ®å¯¹æ¯”
   - åå‘å…¼å®¹æ€§è¯´æ˜

### ğŸ’» ä»£ç ç¤ºä¾‹ï¼ˆæ–°å¢ï¼‰

6. **`examples/skip_waveforms.py`**
   - `example_without_waveforms()` - åŸºæœ¬ç”¨æ³•
   - `example_with_and_without_comparison()` - æ€§èƒ½å¯¹æ¯”
   - `example_memory_usage()` - å†…å­˜ä¼°è®¡

7. **`scripts/demo_skip_waveforms.py`**
   - äº¤äº’å¼æ¼”ç¤ºè„šæœ¬
   - æ¸…æ™°çš„ä½¿ç”¨å»ºè®®
   - å·¥ä½œæµå¯¹æ¯”è¡¨æ ¼

8. **`verify_load_waveforms_feature.py`** âœ… **éªŒè¯è„šæœ¬**
   - è‡ªåŠ¨æµ‹è¯•å‚æ•°å¯ç”¨æ€§
   - éªŒè¯é»˜è®¤å€¼
   - éªŒè¯æ–¹æ³•è¡Œä¸º

### ğŸ§ª æµ‹è¯•æ–‡ä»¶ï¼ˆæ–°å¢ï¼‰

9. **`tests/test_skip_waveforms.py`**
   - `test_without_waveforms()` - ä¸åŠ è½½æ³¢å½¢æµ‹è¯•
   - `test_with_waveforms()` - åŠ è½½æ³¢å½¢æµ‹è¯•
   - è¯¦ç»†çš„æµ‹è¯•è¾“å‡ºå’ŒéªŒè¯

### ğŸ“– å·²æ›´æ–°çš„æ–‡æ¡£

10. **`README.md`** (ä¿®æ”¹)
    - åŠŸèƒ½ç‰¹æ€§æ·»åŠ å†…å­˜ä¼˜åŒ–é¡¹
    - æ–°å¢å†…å­˜ä¼˜åŒ–å¿«é€Ÿå¼€å§‹ç« èŠ‚
    - å‚è€ƒé“¾æ¥åˆ°å®Œæ•´æŒ‡å—

11. **`QUICKSTART.md`** (ä¿®æ”¹)
    - æ–°å¢æ­¥éª¤ 4ï¼šå†…å­˜ä¼˜åŒ–
    - ä»£ç ç¤ºä¾‹å’Œè¯´æ˜
    - æƒè¡¡è¡¨æ ¼

12. **`docs/USAGE.md`** (ä¿®æ”¹)
    - æ–°å¢"å†…å­˜ä¼˜åŒ–"ç« èŠ‚
    - è¯¦ç»†è¯´æ˜å’Œä»£ç ç¤ºä¾‹
    - æ›´æ–°å¸¸è§é—®é¢˜è§£ç­”

13. **`UPDATE_SUMMARY.md`** (æ–°å¢)
    - å®Œæ•´çš„æ›´æ–°æ€»ç»“
    - å˜æ›´ç»Ÿè®¡
    - éªŒè¯æ–¹å¼

---

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬ç”¨æ³•

```python
from waveform_analysis import WaveformDataset

# æ–¹æ¡ˆ A: åªéœ€è¦ç‰¹å¾ï¼ˆæ¨èç”¨äºå¤§æ•°æ®é›†ï¼‰
dataset = WaveformDataset(
    run_name="50V_OV_circulation_20thr",
    load_waveforms=False  # å…³é”®
)

dataset.load_raw_data().extract_waveforms().build_waveform_features().build_dataframe().pair_events()

df = dataset.get_paired_events()
print(f"äº‹ä»¶æ•°: {len(df)}")
print(f"å¹³å‡å³°å€¼: {df['peak_ch6'].mean():.1f} ADC")

# æ–¹æ¡ˆ B: éœ€è¦åŸå§‹æ³¢å½¢ï¼ˆç”¨äºå¯è§†åŒ–ï¼‰
dataset = WaveformDataset(
    run_name="50V_OV_circulation_20thr",
    load_waveforms=True  # é»˜è®¤å€¼
)

dataset.load_raw_data().extract_waveforms().build_waveform_features().build_dataframe().pair_events()

wave, baseline = dataset.get_waveform_at(0)  # âœ… æœ‰æ•ˆ
```

---

## âœ¨ åŠŸèƒ½ç‰¹ç‚¹

âœ… **ç®€å•**: ä»…éœ€ä¸€ä¸ªå¸ƒå°”å‚æ•°
âœ… **å¿«é€Ÿ**: 10x åŠ é€Ÿå¤„ç†
âœ… **é«˜æ•ˆ**: èŠ‚çœ 80% å†…å­˜
âœ… **å…¼å®¹**: å®Œå…¨åå‘å…¼å®¹
âœ… **å®‰å…¨**: è¾¹ç•Œæƒ…å†µå¤„ç†ä¼˜é›…
âœ… **å®Œæ•´**: æ‰€æœ‰ç‰¹å¾ä¿ç•™

---

## ğŸ“‹ æ–‡æ¡£å¯¼èˆª

| éœ€æ±‚ | æ–‡ä»¶ |
| --- | --- |
| æé€Ÿä¸Šæ‰‹ | `QUICK_REFERENCE.md` |
| å¿«é€Ÿç­”æ¡ˆ | `HOW_TO_SKIP_WAVEFORMS.md` |
| å®Œæ•´æŒ‡å— | `docs/MEMORY_OPTIMIZATION.md` |
| ä»£ç ç¤ºä¾‹ | `examples/skip_waveforms.py` |
| æ€§èƒ½æµ‹è¯• | `scripts/demo_skip_waveforms.py` |

---

## âœ… éªŒè¯æ¸…å•

- âœ… æ ¸å¿ƒä»£ç ä¿®æ”¹å®Œæˆ
- âœ… å‚æ•°é»˜è®¤å€¼æ­£ç¡®
- âœ… æ‰€æœ‰æ–¹æ³•æ­£ç¡®ä¿®æ”¹
- âœ… è‡ªåŠ¨åŒ–éªŒè¯è„šæœ¬é€šè¿‡
- âœ… å®Œæ•´æ–‡æ¡£å·²åˆ›å»º
- âœ… å¤šä»½ä»£ç ç¤ºä¾‹å·²æä¾›
- âœ… æµ‹è¯•ç”¨ä¾‹å·²ç¼–å†™
- âœ… å¿«é€Ÿå‚è€ƒå·²å‡†å¤‡
- âœ… åå‘å…¼å®¹æ€§éªŒè¯
- âœ… ç”¨æˆ·æŒ‡å—å®Œå–„

---

## ğŸ¯ å¿«é€Ÿå¼€å§‹

### 1ï¸âƒ£ æŸ¥çœ‹å¿«é€Ÿå‚è€ƒ
```bash
cat QUICK_REFERENCE.md
```

### 2ï¸âƒ£ æŸ¥çœ‹å¿«é€Ÿç­”æ¡ˆ
```bash
cat HOW_TO_SKIP_WAVEFORMS.md
```

### 3ï¸âƒ£ è¿è¡Œæ¼”ç¤ºè„šæœ¬
```bash
python scripts/demo_skip_waveforms.py
```

### 4ï¸âƒ£ æŸ¥çœ‹å®Œæ•´ç¤ºä¾‹
```bash
python examples/skip_waveforms.py
```

### 5ï¸âƒ£ åœ¨ä½ çš„ä»£ç ä¸­ä½¿ç”¨
```python
from waveform_analysis import WaveformDataset

dataset = WaveformDataset(..., load_waveforms=False)
```

---

## ğŸ“ é—®é¢˜æ’æŸ¥

**Q: å‚æ•°å¯ç”¨å—ï¼Ÿ**
A: è¿è¡Œ `python verify_load_waveforms_feature.py` éªŒè¯

**Q: ç‰¹å¾ä¼šä¸¢å¤±å—ï¼Ÿ**
A: ä¸ä¼šï¼Œç‰¹å¾å®Œå…¨ç›¸åŒ

**Q: èƒ½æ··åˆä½¿ç”¨å—ï¼Ÿ**
A: å¯ä»¥ï¼Œåˆ›å»ºä¸¤ä¸ª WaveformDataset å®ä¾‹

**Q: é»˜è®¤æ˜¯åŠ è½½å—ï¼Ÿ**
A: æ˜¯çš„ï¼Œä¿æŒåå‘å…¼å®¹æ€§

---

## ğŸ‰ æ€»ç»“

ç”¨æˆ·ç°åœ¨å¯ä»¥è½»æ¾é€‰æ‹©æ˜¯å¦åŠ è½½æ³¢å½¢ï¼š

```python
# è®°ä½è¿™ä¸€è¡Œå°±å¤Ÿäº†ï¼
dataset = WaveformDataset(..., load_waveforms=False)
```

**èŠ‚çœå†…å­˜**ï¼šä» 500 MB â†’ 100 MBï¼ˆ80% èŠ‚çœï¼‰
**åŠ é€Ÿå¤„ç†**ï¼šä» 30 ç§’ â†’ 3 ç§’ï¼ˆ10x åŠ é€Ÿï¼‰
**ä¿ç•™ç‰¹å¾**ï¼šæ‰€æœ‰ç»Ÿè®¡æ•°æ®å®Œæ•´ä¿ç•™
**å®Œå…¨å…¼å®¹**ï¼šç°æœ‰ä»£ç æ— éœ€ä¿®æ”¹

---

## ğŸ“š æœ€åçš„å»ºè®®

1. **ç¬¬ä¸€æ¬¡ä½¿ç”¨**ï¼šé˜…è¯» `QUICK_REFERENCE.md`
2. **éœ€è¦è¯¦ç»†è¯´æ˜**ï¼šæŸ¥çœ‹ `HOW_TO_SKIP_WAVEFORMS.md`
3. **æƒ³è¦å®Œæ•´æŒ‡å—**ï¼šé˜…è¯» `docs/MEMORY_OPTIMIZATION.md`
4. **æƒ³çœ‹ä»£ç **ï¼šè¿è¡Œ `examples/skip_waveforms.py`
5. **å¼€å§‹ä½¿ç”¨**ï¼šåœ¨ä½ çš„ä»£ç ä¸­æ·»åŠ  `load_waveforms=False`

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼** ğŸš€

---

*åŠŸèƒ½å®ç°å®Œæˆäº 2025 å¹´ 12 æœˆ*
